import{d as x,M as K,Q as M,D as q,a as z,b as G,c as Y,i as J,e as Z,f as X}from"./MainLayout.0004f627.js";import{Q as ee}from"./QImg.512e78e2.js";import{a1 as te,_ as oe,d as ae,u as se,j as l,M as ne,o as s,c as I,w as W,e as k,b as i,$ as le,H as ie,q as r,g as T,f as n,z as F,G as S,Z as f,I as ue,p as re,h as de}from"./index.6c868e6f.js";import{L as ce,D as ve}from"./LoadingSpinner.d914067a.js";import"./QBtn.5feb0ff3.js";import"./render.67790ed9.js";import"./LoginCredential.c897c66b.js";var pe="/assets/clyde_fly.f13c4f1d.webp";const me=te("setup",{state:()=>({daemon:void 0,id:void 0,wpaType:void 0,ssid:"",pass:"",eUsername:"",ePassword:"",jwt:""}),getters:{isWifiEnterprise(){return this.wpaType=="E"},isComplete(){const p=!!this.daemon&&!!this.id&&!!this.wpaType,V=!!this.ssid&&!!this.pass,e=!!this.ssid&&!!this.ePassword&&!!this.eUsername;return p&&(V||e)},getOptions(p){return p}},actions:{}});const v=p=>(re("data-v-00d416b9"),p=p(),de(),p),_e=["onClick"],fe=v(()=>n("br",null,null,-1)),ye={key:2,style:{height:"100%"},class:"column items-center"},he=v(()=>n("h4",null,"No daemons here.",-1)),we=v(()=>n("p",null,"Why don't you get some?",-1)),ge=[he,we],ke={key:0,class:"column items-center"},be=v(()=>n("p",null,[n("b",null,"Your Daemon has been successfully configured! Enjoy.")],-1)),De=v(()=>n("p",null,"Please allow a couple of minutes for the Daemon to calibrate itself and connect to your Wi-Fi network.",-1)),Ce={key:1},Pe=v(()=>n("br",null,null,-1)),Ee={key:2},xe=v(()=>n("p",null,[n("b",null,`If you don't know which one to choose, choose "Personal".`),n("br"),T(" Enterprise access points are often common in places like offices or schools, and require a username and a password. ")],-1)),We={class:"row justify-center"},Fe={key:3,class:"column justify-center items-center"},Se=v(()=>n("label",null,"Wifi SSID:",-1)),Te={key:0},Ve={key:2},Ue={key:4},Ne={key:4},Ie=v(()=>n("p",null,[n("b",null,"You are almost ready to set up your new Daemon."),n("br"),n("br"),T(' Once you click "Finish", your daemon will be automatically configured. ')],-1)),Oe=[Ie],Ae={key:5},Be=ae({__name:"HomePage",setup(p){const V=se(),e=me(),h=l(void 0),m=l(!1),P=l(!1),c=l(void 0),d=l(void 0),y=l(void 0),u=l(void 0),_=l([]),w=l(),E=l("P"),g=l(""),b=l(""),D=l(""),C=l(""),U=l(!1);ne(async()=>await N());const O=async o=>{const t=h.value.find(a=>a.id==o);t&&(t.on=!t.on),await x.toggle(o),await N()},N=async(o=void 0)=>{h.value=await x.getAllUserDaemons(),o&&o()},A=o=>V.push(`daemon/${o}`),B=()=>{e.$reset(),E.value="P",g.value="",b.value="",D.value="",C.value="",U.value=!1,P.value=!1,d.value="Add New Daemon",c.value="auto_fix_high",y.value="cancel",_.value=["next"],u.value=void 0,w.value=$,m.value=!0},$=async()=>{let o;try{o=await J()}catch(t){d.value="Cannot Add New Daemon",c.value="error_outline",u.value=t,_.value=[],y.value="OK",m.value=!0;return}if(e.daemon=o.daemon,e.id=o.id,!e.daemon||!e.id){d.value="Failed to add Daemon",c.value="error_outline",u.value="Daemon provided incorrect characteristics.",m.value=!0;return}d.value="Choose Wi-Fi Type",c.value="wifi",w.value=j},j=async()=>{e.wpaType=E.value,d.value="Input Wi-Fi Credentials",w.value=Q},Q=async()=>{const o=g.value&&b.value,t=g.value&&C.value&&D.value;!o&&!t||(e.ssid=g.value,e.pass=b.value,e.eUsername=D.value,e.ePassword=C.value,d.value="Finish Setup",c.value="auto_fix_high",_.value=["finish"],P.value=!0,w.value=R)},R=async()=>{var t;const o=await x.createDaemon(e.id);if(!o){d.value="Failed to add Daemon",c.value="error_outline",u.value=`We were unable to contact our servers.
        Please check your network connection and try again. Server Response: ${o}`,_.value=[],y.value="OK",m.value=!0;return}if(!o){d.value="Failed to add Daemon",c.value="error_outline",u.value=`We were unable to contact our servers.
        Please check your network connection and try again. Server Response: ${o}`,_.value=[],y.value="OK",m.value=!0;return}e.jwt=o.jwt;try{await Z(e),await X((t=e.daemon)==null?void 0:t.deviceId)}catch{d.value="Failed to add Daemon",c.value="error_outline",u.value="Daemon failed to be configured over BLE. Please reset it and retry.",_.value=[],y.value="OK",m.value=!0;return}e.$reset(),U.value=!0,_.value=[],y.value="OK",P.value=!1,h.value=await x.getAllUserDaemons()},H=[{title:"Add / Recover Daemon",caption:"Add a new daemon to your list, or recover an existing one",icon:"add_circle_outline",action:B}];return(o,t)=>(s(),I(K,{"action-links":H},{default:W(()=>[h.value?h.value.length?(s(),I(M,{key:1,class:"column",id:"container"},{default:W(()=>[k(G,{id:"scroll-container",onRefresh:N,color:"ghostwhite",icon:"autorenew"},{default:W(()=>[(s(!0),i(ie,null,le(h.value,a=>(s(),i("div",{class:"daemon-container wrap fade-in-load",key:a.id,onClick:L=>A(a.id)},[k(q,{dense:!1,daemon:a},null,8,["daemon"]),k(z,{"model-value":a.on,icon:"bolt",size:"5rem",onClick:L=>O(a.id)},null,8,["model-value","onClick"])],8,_e))),128)),fe]),_:1})]),_:1})):(s(),i("div",ye,ge)):(s(),I(ce,{key:0})),k(ve,{modelValue:m.value,"onUpdate:modelValue":t[5]||(t[5]=a=>m.value=a),icon:c.value,persistent:P.value,title:d.value,"close-button":y.value,buttons:_.value,onNext:w.value,onFinish:w.value},{default:W(()=>[U.value?(s(),i("div",ke,[be,k(ee,{src:pe}),De])):(!r(e).daemon||!r(e).id)&&!u.value?(s(),i("p",Ce,[T(" Hey, are you ready to setup your new Daemon? "),Pe,T(' Just press "Next" to get started! ')])):!r(e).wpaType&&!u.value?(s(),i("div",Ee,[xe,n("div",We,[k(Y,{modelValue:E.value,"onUpdate:modelValue":t[0]||(t[0]=a=>E.value=a),options:[{label:"Personal",value:"P"},{label:"Enterprise",value:"E"}],color:"primary",inline:""},null,8,["modelValue"])])])):!r(e).ssid&&!u.value?(s(),i("div",Fe,[Se,F(n("input",{class:"input-form",type:"text","onUpdate:modelValue":t[1]||(t[1]=a=>g.value=a)},null,512),[[S,g.value]]),r(e).isWifiEnterprise?f("",!0):(s(),i("label",Te,"Wifi Password:")),r(e).isWifiEnterprise?f("",!0):F((s(),i("input",{key:1,class:"input-form",type:"password","onUpdate:modelValue":t[2]||(t[2]=a=>b.value=a)},null,512)),[[S,b.value]]),r(e).isWifiEnterprise?(s(),i("label",Ve,"Enterprise Username:")):f("",!0),r(e).isWifiEnterprise?F((s(),i("input",{key:3,class:"input-form","onUpdate:modelValue":t[3]||(t[3]=a=>D.value=a)},null,512)),[[S,D.value]]):f("",!0),r(e).isWifiEnterprise?(s(),i("label",Ue,"Enterprise Password:")):f("",!0),r(e).isWifiEnterprise?F((s(),i("input",{key:5,class:"input-form",type:"password","onUpdate:modelValue":t[4]||(t[4]=a=>C.value=a)},null,512)),[[S,C.value]]):f("",!0)])):r(e).isComplete&&!u.value?(s(),i("div",Ne,Oe)):f("",!0),u.value?(s(),i("p",Ae,ue(u.value),1)):f("",!0)]),_:1},8,["modelValue","icon","persistent","title","close-button","buttons","onNext","onFinish"])]),_:1}))}});var Me=oe(Be,[["__scopeId","data-v-00d416b9"]]);export{Me as default};
